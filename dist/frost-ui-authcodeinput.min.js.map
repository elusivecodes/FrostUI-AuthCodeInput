{"version":3,"names":["AuthCodeInput","BaseComponent","constructor","node","options","super","this","_options","length","$","_wrap","_length","reduce","acc","a","maxLength","getAttribute","_node","_regExp","RegExp","regExp","_render","_events","_refresh","_refreshDisabled","_updateValue","clear","setValue","disable","setAttribute","disabled","dispose","remove","_container","removeAttribute","removeEvent","removeClass","classes","hide","_inputs","enable","getValue","value","defaults","style","autoSubmit","container","divider","input","inputContainer","inputRipple","proto","prototype","addEvent","_","nextInput","find","focus","addEventDelegate","e","target","currentTarget","targetIndex","indexOf","lastIndex","findLastIndex","select","match","code","key","preventDefault","chars","split","char","shift","is","create","class","i","entries","append","j","formInput","attributes","type","required","maxlength","size","pattern","push","rippleLine","addClass","tabindex","before","newValue","map","join","index","triggerEvent","form","closest","requestSubmit","initComponent"],"sources":["../src/auth-code-input.js","../src/index.js","../src/prototype/events.js","../src/prototype/helpers.js","../src/prototype/render.js"],"sourcesContent":["import $ from '@fr0st/query';\nimport { BaseComponent } from '@fr0st/ui';\n\n/**\n * AuthCodeInput Class\n * @class\n */\nexport default class AuthCodeInput extends BaseComponent {\n    /**\n     * New AuthCodeInput constructor.\n     * @param {HTMLElement} node The input node.\n     * @param {object} [options] The options to create the AuthCodeInput with.\n     */\n    constructor(node, options) {\n        super(node, options);\n\n        this._options.length = $._wrap(this._options.length);\n\n        this._length = this._options.length.reduce((acc, a) => acc + a, 0);\n\n        const maxLength = $.getAttribute(this._node, 'maxlength');\n        if (maxLength && this._length > maxLength) {\n            this._length = maxLength;\n            this._options.length = [this._length];\n        }\n\n        this._regExp = new RegExp(this._options.regExp);\n\n        this._render();\n        this._events();\n        this._refresh();\n        this._refreshDisabled();\n        this._updateValue();\n    }\n\n    /**\n     * Clear the AuthCodeInput.\n     */\n    clear() {\n        this.setValue('');\n    }\n\n    /**\n     * Disable the AuthCodeInput.\n     */\n    disable() {\n        $.setAttribute(this._node, { disabled: true });\n        this._refreshDisabled();\n    }\n\n    /**\n     * Dispose the AuthCodeInput.\n     */\n    dispose() {\n        $.remove(this._container);\n        $.removeAttribute(this._node, 'tabindex');\n        $.removeEvent(this._node, 'focus.ui.authcodeinput');\n        $.removeClass(this._node, this.constructor.classes.hide);\n\n        this._container = null;\n        this._inputs = null;\n\n        super.dispose();\n    }\n\n    /**\n     * Enable the AuthCodeInput.\n     */\n    enable() {\n        $.removeAttribute(this._node, 'disabled');\n        this._refreshDisabled();\n    }\n\n    /**\n     * Get the current value.\n     * @return {number} The current value.\n     */\n    getValue() {\n        return $.getValue(this._node);\n    }\n\n    /**\n     * Set the value.\n     * @param {string} value The value.\n     */\n    setValue(value) {\n        $.setValue(this._node, value);\n        this._refresh();\n    }\n}\n","import { initComponent } from '@fr0st/ui';\nimport AuthCodeInput from './auth-code-input.js';\nimport { _events } from './prototype/events.js';\nimport { _refresh, _refreshDisabled, _updateValue } from './prototype/helpers.js';\nimport { _render } from './prototype/render.js';\n\n// AuthCodeInput default options\nAuthCodeInput.defaults = {\n    style: 'outline',\n    length: [3, 3],\n    regExp: '[0-9]',\n    autoSubmit: false,\n};\n\n// AuthCodeInput classes\nAuthCodeInput.classes = {\n    container: 'd-flex justify-content-between',\n    divider: 'vr align-self-center fs-5',\n    hide: 'visually-hidden',\n    input: 'fw-bold text-center px-0',\n    inputContainer: 'form-input w-auto',\n    inputRipple: 'ripple-line',\n};\n\n// AuthCodeInput prototype\nconst proto = AuthCodeInput.prototype;\n\nproto._events = _events;\nproto._refresh = _refresh;\nproto._refreshDisabled = _refreshDisabled;\nproto._render = _render;\nproto._updateValue = _updateValue;\n\n// AuthCodeInput init\ninitComponent('authcodeinput', AuthCodeInput);\n\nexport default AuthCodeInput;\n","import $ from '@fr0st/query';\n\n/**\n * Attach events for the AuthCodeInput.\n */\nexport function _events() {\n    $.addEvent(this._node, 'focus.ui.authcodeinput', (_) => {\n        const nextInput = this._inputs.find((input) => !$.getValue(input));\n        $.focus(nextInput || this._inputs[0]);\n    });\n\n    $.addEventDelegate(this._container, 'focusin.ui.authcodeinput', 'input', (e) => {\n        const target = e.currentTarget;\n        const targetIndex = this._inputs.indexOf(target);\n        const lastIndex = this._inputs.findLastIndex((input) => $.getValue(input));\n\n        if (targetIndex > lastIndex + 1 && lastIndex < this._inputs.length) {\n            $.focus(this._inputs[lastIndex + 1]);\n        } else {\n            $.select(target);\n        }\n    });\n\n    $.addEventDelegate(this._container, 'input.ui.authcodeinput', 'input', (e) => {\n        const target = e.currentTarget;\n        let value = $.getValue(target);\n\n        if (value && !value.match(this._regExp)) {\n            value = '';\n            $.setValue(target, value);\n        }\n\n        this._updateValue();\n\n        if (!value) {\n            return;\n        }\n\n        const targetIndex = this._inputs.indexOf(target);\n\n        if (targetIndex < this._inputs.length) {\n            $.focus(this._inputs[targetIndex + 1]);\n        }\n    });\n\n    $.addEventDelegate(this._container, 'keydown.ui.authcodeinput', 'input', (e) => {\n        const target = e.currentTarget;\n        const targetIndex = this._inputs.indexOf(target);\n\n        switch (e.code) {\n            case 'ArrowLeft':\n                if (targetIndex > 0) {\n                    $.focus(this._inputs[targetIndex - 1]);\n                }\n                break;\n            case 'ArrowRight':\n                if (targetIndex < this._inputs.length) {\n                    $.focus(this._inputs[targetIndex + 1]);\n                }\n                break;\n            case 'Backspace':\n                if ($.getValue(target)) {\n                    $.setValue(target, '');\n\n                    this._updateValue();\n                } else if (targetIndex > 0) {\n                    $.setValue(this._inputs[targetIndex - 1], '');\n                    $.focus(this._inputs[targetIndex - 1]);\n                }\n                break;\n            default:\n                if (e.key.length !== 1 || e.key.match(this._regExp)) {\n                    return;\n                }\n                break;\n        }\n\n        e.preventDefault();\n    });\n};\n","import $ from '@fr0st/query';\n\n/**\n * Refresh the input value.\n */\nexport function _refresh() {\n    const chars = $.getValue(this._node).split('');\n\n    for (const input of this._inputs) {\n        let char;\n\n        do {\n            char = chars.shift();\n        } while (char && !char.match(this._regExp));\n\n        $.setValue(input, char || '');\n    }\n\n    this._updateValue();\n};\n\n/**\n * Refresh the disabled styling.\n */\nexport function _refreshDisabled() {\n    if ($.is(this._node, ':disabled')) {\n        $.setAttribute(this._inputs, { disabled: 'true' });\n    } else {\n        $.removeAttribute(this._inputs, 'disabled');\n    }\n};\n\n/**\n * Update the value.\n */\nexport function _updateValue() {\n    const newValue = this._inputs\n        .map((node) => $.getValue(node))\n        .join('');\n\n    const lastIndex = this._inputs.findLastIndex((input) => $.getValue(input));\n\n    for (const [index, input] of this._inputs.entries()) {\n        if (index && index > lastIndex + 1) {\n            $.setAttribute(input, { tabindex: -1 });\n        } else {\n            $.removeAttribute(input, 'tabindex');\n        }\n    }\n\n    if (newValue === this.getValue()) {\n        return;\n    }\n\n    $.setValue(this._node, newValue);\n\n    $.triggerEvent(this._node, 'change.ui.authcodeinput');\n\n    if (this._options.autoSubmit && newValue.length === this._length) {\n        const form = $.closest(this._node, 'form').shift();\n\n        if (form) {\n            form.requestSubmit();\n        }\n    }\n};\n","import $ from '@fr0st/query';\n\n/**\n * Render the AuthCodeInput.\n */\nexport function _render() {\n    this._container = $.create('div', {\n        class: this.constructor.classes.container,\n    });\n\n    this._inputs = [];\n\n    for (const [i, length] of this._options.length.entries()) {\n        if (i > 0) {\n            const divider = $.create('span', {\n                class: this.constructor.classes.divider,\n            });\n            $.append(this._container, divider);\n        }\n\n        for (let j = 0; j < length; j++) {\n            const formInput = $.create('div', {\n                class: this.constructor.classes.inputContainer,\n            });\n\n            const input = $.create('input', {\n                class: [\n                    `input-${this._options.style}`,\n                    this.constructor.classes.input,\n                ],\n                attributes: {\n                    type: 'text',\n                    required: true,\n                    maxlength: 1,\n                    size: 1,\n                    pattern: this._options.regExp,\n                },\n            });\n\n            $.append(formInput, input);\n\n            this._inputs.push(input);\n\n            if (this._options.style === 'filled') {\n                const rippleLine = $.create('div', {\n                    class: this.constructor.classes.inputRipple,\n                });\n\n                $.append(formInput, rippleLine);\n            }\n\n            $.append(this._container, formInput);\n        }\n    }\n\n    // hide the input node\n    $.addClass(this._node, this.constructor.classes.hide);\n    $.setAttribute(this._node, { tabindex: -1 });\n\n    $.before(this._node, this._container);\n};\n"],"mappings":"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"}