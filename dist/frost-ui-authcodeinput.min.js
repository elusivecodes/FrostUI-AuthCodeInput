!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@fr0st/ui"),require("@fr0st/query")):"function"==typeof define&&define.amd?define(["exports","@fr0st/ui","@fr0st/query"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).UI=t.UI||{},t.UI,t.fQuery)}(this,(function(t,e,s){"use strict";class i extends e.BaseComponent{constructor(t,e){super(t,e),this._options.length=s._wrap(this._options.length),this._length=this._options.length.reduce(((t,e)=>t+e),0);const i=s.getAttribute(this._node,"maxlength");i&&this._length>i&&(this._length=i,this._options.length=[this._length]),this._regExp=new RegExp(this._options.regExp),this._render(),this._events(),this._refresh(),this._refreshDisabled(),this._updateValue()}clear(){this.setValue("")}disable(){s.setAttribute(this._node,{disabled:!0}),this._refreshDisabled()}dispose(){s.remove(this._container),s.removeAttribute(this._node,"tabindex"),s.removeEvent(this._node,"focus.ui.authcodeinput"),s.removeClass(this._node,this.constructor.classes.hide),this._container=null,this._inputs=null,super.dispose()}enable(){s.removeAttribute(this._node,"disabled"),this._refreshDisabled()}getValue(){return s.getValue(this._node)}setValue(t){s.setValue(this._node,t),this._refresh()}}i.defaults={style:"outline",length:[3,3],regExp:"[0-9]",autoSubmit:!1},i.classes={container:"d-flex justify-content-between",divider:"vr align-self-center fs-5",hide:"visually-hidden",input:"fw-bold text-center px-0",inputContainer:"form-input w-auto",inputRipple:"ripple-line"};const n=i.prototype;n._events=function(){s.addEvent(this._node,"focus.ui.authcodeinput",(t=>{const e=this._inputs.find((t=>!s.getValue(t)));s.focus(e||this._inputs[0])})),s.addEventDelegate(this._container,"focusin.ui.authcodeinput","input",(t=>{const e=t.currentTarget,i=this._inputs.indexOf(e),n=this._inputs.findLastIndex((t=>s.getValue(t)));i>n+1&&n<this._inputs.length?s.focus(this._inputs[n+1]):s.select(e)})),s.addEventDelegate(this._container,"input.ui.authcodeinput","input",(t=>{const e=t.currentTarget;let i=s.getValue(e);if(i&&!i.match(this._regExp)&&(i="",s.setValue(e,i)),this._updateValue(),!i)return;const n=this._inputs.indexOf(e);n<this._inputs.length&&s.focus(this._inputs[n+1])})),s.addEventDelegate(this._container,"keydown.ui.authcodeinput","input",(t=>{const e=t.currentTarget,i=this._inputs.indexOf(e);switch(t.code){case"ArrowLeft":i>0&&s.focus(this._inputs[i-1]);break;case"ArrowRight":i<this._inputs.length&&s.focus(this._inputs[i+1]);break;case"Backspace":s.getValue(e)?(s.setValue(e,""),this._updateValue()):i>0&&(s.setValue(this._inputs[i-1],""),s.focus(this._inputs[i-1]));break;default:if(1!==t.key.length||t.key.match(this._regExp))return}t.preventDefault()}))},n._refresh=function(){const t=s.getValue(this._node).split("");for(const e of this._inputs){let i;do{i=t.shift()}while(i&&!i.match(this._regExp));s.setValue(e,i||"")}this._updateValue()},n._refreshDisabled=function(){s.is(this._node,":disabled")?s.setAttribute(this._inputs,{disabled:"true"}):s.removeAttribute(this._inputs,"disabled")},n._render=function(){this._container=s.create("div",{class:this.constructor.classes.container}),this._inputs=[];for(const[t,e]of this._options.length.entries()){if(t>0){const t=s.create("span",{class:this.constructor.classes.divider});s.append(this._container,t)}for(let t=0;t<e;t++){const t=s.create("div",{class:this.constructor.classes.inputContainer}),e=s.create("input",{class:[`input-${this._options.style}`,this.constructor.classes.input],attributes:{type:"text",required:!0,maxlength:1,size:1,pattern:this._options.regExp}});if(s.append(t,e),this._inputs.push(e),"filled"===this._options.style){const e=s.create("div",{class:this.constructor.classes.inputRipple});s.append(t,e)}s.append(this._container,t)}}s.addClass(this._node,this.constructor.classes.hide),s.setAttribute(this._node,{tabindex:-1}),s.before(this._node,this._container)},n._updateValue=function(){const t=this._inputs.map((t=>s.getValue(t))).join(""),e=this._inputs.findLastIndex((t=>s.getValue(t)));for(const[t,i]of this._inputs.entries())t&&t>e+1?s.setAttribute(i,{tabindex:-1}):s.removeAttribute(i,"tabindex");if(t!==this.getValue()&&(s.setValue(this._node,t),s.triggerEvent(this._node,"change.ui.authcodeinput"),this._options.autoSubmit&&t.length===this._length)){const t=s.closest(this._node,"form").shift();t&&t.requestSubmit()}},e.initComponent("authcodeinput",i),t.AuthCodeInput=i}));